{
    "bk_biz_id":591,
    "table_name":"bk_table_sql_verify",
    "return_table_name":"bk_table_sql_verify_return",
    "scopes":{
        "bk_table_sql_verify":[
            {
                "field_name":"UID",
                "field_type":"int"
            },
            {
                "field_name":"b",
                "field_type":"long"
            },
            {
                "field_name":"c",
                "field_type":"float"
            },
            {
                "field_name":"d",
                "field_type":"double"
            },
            {
                "field_name":"e",
                "field_type":"string"
            }
        ]
    },
    "require_schema":{
        "bk_table_sql_verify_return":[
            {
                "field_name":"UID",
                "field_type":"int"
            },
            {
                "field_name":"b",
                "field_type":"long"
            },
            {
                "field_name":"c",
                "field_type":"float"
            },
            {
                "field_name":"d",
                "field_type":"double"
            },
            {
                "field_name":"e",
                "field_type":"string"
            }
        ]
    },
    "sql_parts":{
        "bk_biz_id":591,
        "table_name":"bk_table_sql_verify",
        "fields": {
            "UID": "`UID` as `UID`",
            "b": "cast(b as float)",
            "c": "concat(UID, '.',c) as c",
            "d": "d as d as d as d ",
            "e": "case e when 1 then '一' when 2 then '二' else '三' end as e"
        },
        "conditions":" c > 100"
    },
    "sql_parse_statement":"SELECT /*测试注释*/ aaa, case c_ase when 1 then '一' when 2 then '二' else '三' end,   cast(case table1.a when 1 then table2.b when 2 then '二' else c end as int) as    a,  count(uid) as bb, udf_123(concat(cc, '', s)) as udf, AGE, if(a>0, 1, a+1) as count, ResulT, UID count FROM 1_presto_cluster1 where 1=1 ;",
    "ret_sql_tree":{
        "selectBody":{
            "forUpdate":false,
            "oracleSiblings":false,
            "astnode":{
                "id":5
            },
            "selectItems":[
                {
                    "expression":{
                        "expressionType":"case_expression",
                        "switchExpression":{
                            "expressionType":"column",
                            "table":{
                                "fullyQualifiedName":"",
                                "database":{
                                    "fullyQualifiedName":""
                                }
                            },
                            "fullyQualifiedName":"c_ase",
                            "astnode":{
                                "id":3
                            },
                            "columnName":"c_ase"
                        },
                        "elseExpression":{
                            "expressionType":"string_value",
                            "notExcapedValue":"三",
                            "escapedValue":"'三'",
                            "value":"三",
                            "astnode":{
                                "id":14
                            }
                        },
                        "whenClauses":[
                            {
                                "expressionType":"when_clause",
                                "whenExpression":{
                                    "expressionType":"long_value",
                                    "stringValue":"1",
                                    "bigIntegerValue":1,
                                    "value":1
                                },
                                "thenExpression":{
                                    "expressionType":"string_value",
                                    "notExcapedValue":"一",
                                    "escapedValue":"'一'",
                                    "value":"一",
                                    "astnode":{
                                        "id":14
                                    }
                                }
                            },
                            {
                                "expressionType":"when_clause",
                                "whenExpression":{
                                    "expressionType":"long_value",
                                    "stringValue":"2",
                                    "bigIntegerValue":2,
                                    "value":2
                                },
                                "thenExpression":{
                                    "expressionType":"string_value",
                                    "notExcapedValue":"二",
                                    "escapedValue":"'二'",
                                    "value":"二",
                                    "astnode":{
                                        "id":14
                                    }
                                }
                            }
                        ]
                    },
                    "astnode":{
                        "id":8
                    },
                    "type":"select_expr_item",
                    "alias":{
                        "useAs":true,
                        "name":"c_ase"
                    }
                },
                {
                    "expression":{
                        "expressionType":"cast_expression",
                        "leftExpression":{
                            "expressionType":"case_expression",
                            "switchExpression":{
                                "expressionType":"column",
                                "table":{
                                    "fullyQualifiedName":"table1",
                                    "name":"table1",
                                    "database":{
                                        "fullyQualifiedName":""
                                    }
                                },
                                "fullyQualifiedName":"table1.a",
                                "astnode":{
                                    "id":3
                                },
                                "columnName":"a"
                            },
                            "elseExpression":{
                                "expressionType":"column",
                                "table":{
                                    "fullyQualifiedName":"",
                                    "database":{
                                        "fullyQualifiedName":""
                                    }
                                },
                                "fullyQualifiedName":"c",
                                "astnode":{
                                    "id":3
                                },
                                "columnName":"c"
                            },
                            "whenClauses":[
                                {
                                    "expressionType":"when_clause",
                                    "whenExpression":{
                                        "expressionType":"long_value",
                                        "stringValue":"1",
                                        "bigIntegerValue":1,
                                        "value":1
                                    },
                                    "thenExpression":{
                                        "expressionType":"column",
                                        "table":{
                                            "fullyQualifiedName":"table2",
                                            "name":"table2",
                                            "database":{
                                                "fullyQualifiedName":""
                                            }
                                        },
                                        "fullyQualifiedName":"table2.b",
                                        "astnode":{
                                            "id":3
                                        },
                                        "columnName":"b"
                                    }
                                },
                                {
                                    "expressionType":"when_clause",
                                    "whenExpression":{
                                        "expressionType":"long_value",
                                        "stringValue":"2",
                                        "bigIntegerValue":2,
                                        "value":2
                                    },
                                    "thenExpression":{
                                        "expressionType":"string_value",
                                        "notExcapedValue":"二",
                                        "escapedValue":"'二'",
                                        "value":"二",
                                        "astnode":{
                                            "id":14
                                        }
                                    }
                                }
                            ]
                        },
                        "type":{
                            "dataType":"int",
                            "arrayData":[

                            ]
                        },
                        "useCastKeyword":true
                    },
                    "astnode":{
                        "id":8
                    },
                    "type":"select_expr_item",
                    "alias":{
                        "useAs":true,
                        "name":"a"
                    }
                },
                {
                    "expression":{
                        "escaped":false,
                        "name":"count",
                        "parameters":{
                            "expressions":[
                                {
                                    "expressionType":"column",
                                    "table":{
                                        "fullyQualifiedName":"",
                                        "database":{
                                            "fullyQualifiedName":""
                                        }
                                    },
                                    "fullyQualifiedName":"uid",
                                    "astnode":{
                                        "id":3
                                    },
                                    "columnName":"uid"
                                }
                            ]
                        },
                        "expressionType":"function",
                        "allColumns":false,
                        "distinct":false,
                        "astnode":{
                            "id":16
                        }
                    },
                    "astnode":{
                        "id":8
                    },
                    "type":"select_expr_item",
                    "alias":{
                        "useAs":true,
                        "name":"bb"
                    }
                },
                {
                    "expression":{
                        "escaped":false,
                        "name":"udf_123",
                        "parameters":{
                            "expressions":[
                                {
                                    "escaped":false,
                                    "name":"concat",
                                    "parameters":{
                                        "expressions":[
                                            {
                                                "expressionType":"column",
                                                "table":{
                                                    "fullyQualifiedName":"",
                                                    "database":{
                                                        "fullyQualifiedName":""
                                                    }
                                                },
                                                "fullyQualifiedName":"cc",
                                                "astnode":{
                                                    "id":3
                                                },
                                                "columnName":"cc"
                                            },
                                            {
                                                "expressionType":"string_value",
                                                "notExcapedValue":"",
                                                "escapedValue":"''",
                                                "value":"",
                                                "astnode":{
                                                    "id":14
                                                }
                                            },
                                            {
                                                "expressionType":"column",
                                                "table":{
                                                    "fullyQualifiedName":"",
                                                    "database":{
                                                        "fullyQualifiedName":""
                                                    }
                                                },
                                                "fullyQualifiedName":"s",
                                                "astnode":{
                                                    "id":3
                                                },
                                                "columnName":"s"
                                            }
                                        ]
                                    },
                                    "expressionType":"function",
                                    "allColumns":false,
                                    "distinct":false,
                                    "astnode":{
                                        "id":16
                                    }
                                }
                            ]
                        },
                        "expressionType":"function",
                        "allColumns":false,
                        "distinct":false,
                        "astnode":{
                            "id":16
                        }
                    },
                    "astnode":{
                        "id":8
                    },
                    "type":"select_expr_item",
                    "alias":{
                        "useAs":true,
                        "name":"udf"
                    }
                },
                {
                    "expression":{
                        "expressionType":"column",
                        "table":{
                            "fullyQualifiedName":"",
                            "database":{
                                "fullyQualifiedName":""
                            }
                        },
                        "fullyQualifiedName":"AGE",
                        "astnode":{
                            "id":3
                        },
                        "columnName":"AGE"
                    },
                    "type":"select_expr_item",
                    "astnode":{
                        "id":8
                    }
                },
                {
                    "expression":{
                        "escaped":false,
                        "name":"if",
                        "parameters":{
                            "expressions":[
                                {
                                    "leftExpression":{
                                        "expressionType":"column",
                                        "table":{
                                            "fullyQualifiedName":"",
                                            "database":{
                                                "fullyQualifiedName":""
                                            }
                                        },
                                        "fullyQualifiedName":"a",
                                        "astnode":{
                                            "id":3
                                        },
                                        "columnName":"a"
                                    },
                                    "stringExpression":">",
                                    "expressionType":"greater_than",
                                    "rightExpression":{
                                        "expressionType":"long_value",
                                        "stringValue":"0",
                                        "bigIntegerValue":0,
                                        "value":0
                                    },
                                    "oraclePriorPosition":0,
                                    "oldOracleJoinSyntax":0,
                                    "not":false,
                                    "astnode":{
                                        "id":12
                                    }
                                },
                                {
                                    "expressionType":"long_value",
                                    "stringValue":"1",
                                    "bigIntegerValue":1,
                                    "value":1
                                },
                                {
                                    "not":false,
                                    "expressionType":"addition",
                                    "leftExpression":{
                                        "expressionType":"column",
                                        "table":{
                                            "fullyQualifiedName":"",
                                            "database":{
                                                "fullyQualifiedName":""
                                            }
                                        },
                                        "fullyQualifiedName":"a",
                                        "astnode":{
                                            "id":3
                                        },
                                        "columnName":"a"
                                    },
                                    "stringExpression":"+",
                                    "rightExpression":{
                                        "expressionType":"long_value",
                                        "stringValue":"1",
                                        "bigIntegerValue":1,
                                        "value":1
                                    }
                                }
                            ]
                        },
                        "expressionType":"function",
                        "allColumns":false,
                        "distinct":false,
                        "astnode":{
                            "id":16
                        }
                    },
                    "astnode":{
                        "id":8
                    },
                    "type":"select_expr_item",
                    "alias":{
                        "useAs":true,
                        "name":"count"
                    }
                },
                {
                    "expression":{
                        "expressionType":"column",
                        "table":{
                            "fullyQualifiedName":"",
                            "database":{
                                "fullyQualifiedName":""
                            }
                        },
                        "fullyQualifiedName":"ResulT",
                        "astnode":{
                            "id":3
                        },
                        "columnName":"ResulT"
                    },
                    "type":"select_expr_item",
                    "astnode":{
                        "id":8
                    }
                },
                {
                    "expression":{
                        "expressionType":"column",
                        "table":{
                            "fullyQualifiedName":"",
                            "database":{
                                "fullyQualifiedName":""
                            }
                        },
                        "fullyQualifiedName":"UID",
                        "astnode":{
                            "id":3
                        },
                        "columnName":"UID"
                    },
                    "astnode":{
                        "id":8
                    },
                    "type":"select_expr_item",
                    "alias":{
                        "useAs":false,
                        "name":"count"
                    }
                }
            ],
            "where":{
                "leftExpression":{
                    "expressionType":"long_value",
                    "stringValue":"1",
                    "bigIntegerValue":1,
                    "value":1
                },
                "stringExpression":"=",
                "expressionType":"equals_to",
                "rightExpression":{
                    "expressionType":"long_value",
                    "stringValue":"1",
                    "bigIntegerValue":1,
                    "value":1
                },
                "oraclePriorPosition":0,
                "oldOracleJoinSyntax":0,
                "not":false,
                "astnode":{
                    "id":12
                }
            },
            "fromItem":{
                "fullyQualifiedName":"1_presto_cluster1",
                "name":"1_presto_cluster1",
                "database":{
                    "fullyQualifiedName":"",
                    "server":{
                        "fullyQualifiedName":""
                    }
                }
            },
            "useBrackets":false
        }
    }
}
